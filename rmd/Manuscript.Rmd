---
title: "Displacement effects in PIPA"
author: "Juan Carlos Villase√±or-Derbez"
# abstract: "Large-scale Marine Protected Areas (LSMPAs) have seen a significant increase over the last years. Literature shows that fishing effort is effectively eliminated in this protected areas upon implementation. The benefits of reducing effort have been largely studied, and include increases in abundance, biomass, and diversity within the bounded regions. In terms of the fishing implication, no-take zones may produce spillover that provide fish for outside areas. The implications of displacement of fishing effort are not yet fully understood. Evidence suggests that fishing effort re-distributes along the borders of the MPA, following an ideal free distribution. Novel data products allow us to track fishing effort at the vessel-level, allowing us to identify changes in behavior at both the fleet and vessel level. This papers evaluates the implications of implementing a LMPA, the Phoenix Islands Protected Area (PIPA). We evaluate changes in fishing effort, and track vessels to see where they go after the implementation of PIPA. Our results show that vessels in the effected region increase fishing effort after the implementation of PIPA. THey are redistributed to X. These findings have major implications for MPA implementation, especially as countries rush to meet the goals of 10% ocean protection as mandated by the SDG."
output:
  bookdown::pdf_document2:
    toc: yes
    toc_depth: 4
    citation_package: natbib
    keep_tex: yes
    number_sections: no
header-includes:
  - \usepackage{float}
  - \floatplacement{figure,table}{H}
bibliography: references.bib
biblio-style: nature
---

*Last update: `r Sys.Date()`*

```{r, echo = F, message = F, warning = F}
suppressPackageStartupMessages({
  library(startR)
  library(tidyverse)
})

knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)
```

# To do

- [x] Divide pipa vessels by type of boat (longline vs. purse seine)
- [x] Identify two counterfactuals:
    -  [x] A: PNA, similar vessel, never fished inside PIPA
    - [ ] B: Taiwan, Never in PNA, Similar region
- [x] Change in fishing hours before vs after
- [ ] ~~Change in total hours before vs after~~
- [ ] Change in distance before vs after
- [ ] Where do PIPA vessels go?
- [ ] Make sure I have full tracks of all mmsis

\clearpage

# Methods

## Data


```{r}
effort_by_vessel <- read.csv(file = here::here("data", "effort_by_vessel.csv"))
```

```{r}
# Just to get pipa vessels that fished inside pipa before 2015
pipa_vessels <- effort_by_vessel %>% 
  filter(treated) %$%
  unique(mmsi) %>% 
  length()

n_prev <- effort_by_vessel %>% 
  filter(treated, !post) %$%
  unique(mmsi) %>% 
  length()

n_post <- effort_by_vessel %>% 
  filter(treated, post, baci_strict) %$%
  unique(mmsi) %>% 
  length()

```


The Global Fishing Watch (GFW) data contain `r pipa_vessels` vessels that have fished within PIPA waters. From these, `r n_prev` did so at least once before 2015, but only `r n_post` continued to fish after 2015. The `r n_prev - n_post` missing vessels might tell us something about the impact of PIPA. However, they might have gone to other areas (i.e. outside of PNA countries). I must dig deeper into this.

Accounting for the fact that vessels that fished within PIPA before implementation might stop fishing afterwards, or that vessels entered the fishery after PIPA closure, I define my treatment and control groups as follows. The treatment group contains all vessels that fished within PIPA at least once before the closure, and that continued to fish elsewhere afterwards. The Control group has vessels that never fished within PIPA waters, belong to other PNA countries, and have fished in surroinding areas before and after PIPA closure. Tables \ref{tab:baci_n}, \ref{tab:baci_n_s}, and \ref{tab:baci_h} show the number of vessels, number of vessels following a BACI design, and fishing hours, respectively. Tables show data grouped by gear (longlines, purse seines), group (treated, control), and period (before, after). The relative change (After / Before) is also shown. Table \ref{tab:baci_n} shows information for all fishing vessels in the dataset, while Tables \ref{tab:baci_n_s} and \ref{tab:baci_h} show information for vessels that meet the BACI design (i.e. excludes vessels that only appear at one point in time).


```{r}
effort_by_vessel %>% 
  # filter(baci_strict) %>%
  group_by(gear, treated, post, mmsi) %>% 
  count() %>% 
  ungroup() %>% 
  group_by(gear, treated, post) %>% 
  summarize(boats = n()) %>% 
  spread(post, boats) %>% 
  mutate(change = `TRUE` / `FALSE`) %>% 
  knitr::kable(col.names = c("Gear", "Treatment", "Before", "After", "Change (A / B)"),
               caption = "\\label{tab:baci_n}Number of fishing vessels (identified by mmsi) for each gear before and after PIPA implementation.",
               booktabs = T) %>% 
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

```{r}
effort_by_vessel %>% 
  filter(baci_strict) %>%
  group_by(gear, treated, post, mmsi) %>% 
  count() %>% 
  ungroup() %>% 
  group_by(gear, treated, post) %>% 
  summarize(boats = n()) %>% 
  spread(post, boats) %>% 
  mutate(change = `TRUE` / `FALSE`) %>% 
  knitr::kable(col.names = c("Gear", "Treatment", "Before", "After", "Change (A / B)"),
               caption = "\\label{tab:baci_n_s}Number of fishing vessels (identified by mmsi) for each gear before and after PIPA implementation.",
               booktabs = T) %>% 
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

```{r}
effort_by_vessel %>%
  filter(baci_strict) %>%
  group_by(gear, treated, post) %>% 
  summarize(hours = mean(hours, na.rm = T)) %>% 
  spread(post, hours) %>% 
  mutate(change = `TRUE` / `FALSE`) %>% 
  knitr::kable(col.names = c("Gear", "Treatment", "Before", "After", "Change (A / B)"),
               caption = "\\label{tab:baci_h}Mean fishing hours for each gear before and after",
               booktabs = T) %>% 
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

## Analysis

The current approach is to estimate what percentage of fishing effort from the PNA was displaced by PIPA and use this to infer something about Palau. While this provides a measure of the displacement, it does not fully address the possibility of costs increasing. I believ we can use individual tracks (as opposed to just the gridded effort) and obtain show how their behavior changed (*i.e.* are they fishing further away, are they fishing more, where are they now?).

### Model specifications

<!-- $$ -->
<!-- H_{ijk} = \alpha + \beta Post_i + \mu_j + \phi_k + \epsilon_{ijk} -->
<!-- $$ -->

<!-- Where $H_{ijk}$ is a measure of effort (*.i.e.* total hours, fishing hours, distance traveled), $\beta$ captures the change for before ($Post_i = 0$) and after ($Post_i = 1$) implementation of PIPA, $mu_j$ captures the month fixed-effects, and $\phi_k$ captures vessel-level fixed-effects. We use this general model and the nested specifications which drop the month and vessel-level fixed effects to test for differences. -->

Our model specification uses a DiD approach. In this case, we interact the before-after dummy with a treatment dummy. The treatment and control groups follow our definition in the data description. The model takes the form of:

$$
H_{ijkl} = \alpha + \beta Post_i \times Treat + \mu_j + \phi_k + \gamma_l+ \epsilon_{ijk}
$$

Where $\mu_j$, $\phi_k$, and $\gamma_l$ represent month-, year-, and flag-level fixed effects. I use total hours at the vessel-month level.

# Results

Fig. \ref{fig:all_vessels} shows that mean fishing hours for purse seiners have an abrupt increase, just before January 1st, 2015. This trend is observed for both treated and control groups. Longliners, however, show a more stable trend. The number of mmsi codes increases through time. This can largel be explained by the addition of more satellits, which increasedetectability of vessels. As expected total fishing hours follow a similar trend to that of mmsi numbers. Results of the regressions for each gear type are shown in Tables \ref{tab:purse} and \ref{tab:long}. Column (1) presents the DiD regression with no fixed effects, column (2) includes month fixed effects, column (3) includes month and year fixed effects, and column (4) includes month, year, and flag fixed effects. Figures \ref{fig:puse} and \ref{fig:long} represent the same coefficient estimates.


```{r, echo = F, fig.cap = "\\label{fig:all_vessels}Fishing hours and number of vessels by month for all vessels. Vertical dashed line indicates PIPA closure."}
effort_by_vessel %>% 
  filter(baci_strict) %>%
  group_by(year, gear, treated, post, month) %>% 
  summarize(total_hours = sum(hours),
            mean_hours = mean(hours),
            n_mmsi = n()) %>% 
  ungroup() %>% 
  mutate(date = lubridate::date(paste(year, month, "01", sep = "/"))) %>% 
  select(-year) %>% 
  gather(variable, value, -c(date, month, post, gear, treated)) %>% 
  ggplot(aes(x = date, y = value, color = treated)) +
  geom_line() +
  geom_point() +
  facet_wrap(gear~variable, scales = "free", ncol = 3) +
  theme_bw() +
  scale_color_brewer(palette = "Set1") +
  geom_vline(xintercept = lubridate::date(paste(2015, 01, "01", sep = "/")), linetype = "dashed")
```

\clearpage

## Purse seiners

```{r, results = "asis", echo = F}

model_data <- effort_by_vessel %>% 
  filter(baci_strict,
         gear == "purse_seines") %>% 
  mutate(post = post * 1,
         treated = treated * 1) %>% 
  mutate_at(.vars = vars(month, year, mmsi), .funs = as.character)

m1 <- lm(hours ~ post*treated, data = model_data)
m2 <- lm(hours ~ post*treated + month, data = model_data)
m3 <- lm(hours ~ post*treated + month + year, data = model_data)
m4 <- lm(hours ~ post*treated + month + year + flag, data = model_data)

models <- list(m1, m2, m3, m4)

stargazer::stargazer(models,
                     se = commarobust::makerobustseslist(models),
                     t.auto = T,
                     p.auto = T,
                     type = "latex",
                     omit = c("flag", "year", "month"),
                     add.lines = list(c("Month FE", "No", "Yes", "Yes", "Yes"),
                                      c("Year FE", "No", "No", "Yes", "Yes"),
                                      c("Flag FE", "No", "No", "No", "Yes")),
                     omit.stat = c("adj.rsq", "f", "ser"),
                     header = F,
                     title = "\\label{tab:purse}Fishing hours from GFW for purse seiners (n = 106; 38 control, 68 treatment). Asterisks indicate significance levels. Numbers in parenthesis represent heteroskedastic-robuste standard errors.")
```

```{r, fig.cap = "\\label{fig:puse}Coefficient estimates for each model. Top pannel indicates variable, x-axis represents model specification, and y-axis coefficient estimate."}
map_df(models, broom::tidy, .id = "model") %>%
  filter(term %in% c("(Intercept)", "post", "treated", "post:treated")) %>%
  ggplot(aes(x = model, y = estimate)) +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error),
                size = 1,
                width = 0,
                color = "red") +
  geom_point(color = "steelblue", size = 3) +
  facet_wrap(~term, scale = "free") +
  theme_bw()
```

\clearpage

## Longliners

```{r, results = "asis"}

model_data <- effort_by_vessel %>% 
  filter(baci_strict,
         !gear == "purse_seines") %>% 
  mutate(post = post * 1,
         treated = treated * 1) %>% 
  mutate_at(.vars = vars(month, year, mmsi), .funs = as.character)

m1 <- lm(hours ~ post*treated, data = model_data)
m2 <- lm(hours ~ post*treated + month, data = model_data)
m3 <- lm(hours ~ post*treated + month + year, data = model_data)
m4 <- lm(hours ~ post*treated + month + year + flag, data = model_data)

models <- list(m1, m2, m3, m4)

stargazer::stargazer(models,
                     se = commarobust::makerobustseslist(models),
                     t.auto = T,
                     p.auto = T,
                     type = "latex",
                     omit = c("flag", "year", "month"),
                     add.lines = list(c("Month FE", "No", "Yes", "Yes", "Yes"),
                                      c("Year FE", "No", "No", "Yes", "Yes"),
                                      c("Flag FE", "No", "No", "No", "Yes")),
                     omit.stat = c("adj.rsq", "f", "ser"),
                     header = F,
                     title = "\\label{tab:long}Fishing hours from GFW for longliners (n = 203; 88 control, 115 treatment).. Asterisks indicate significance levels. Numbers in parenthesis represent heteroskedastic-robuste standard errors.")
```

```{r, fig.cap = "\\label{fig:long}Coefficient estimates for each model. Top pannel indicates variable, x-axis represents model specification, and y-axis coefficient estimate."}
map_df(models, broom::tidy, .id = "model") %>%
  filter(term %in% c("(Intercept)", "post", "treated", "post:treated")) %>%
  ggplot(aes(x = model, y = estimate)) +
  geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error),
                size = 1,
                width = 0,
                color = "red") +
  geom_point(color = "steelblue", size = 3) +
  facet_wrap(~term, scale = "free") +
  theme_bw()
```


<!-- # Discusion -->

<!-- ### Further work -->

<!-- In order to strengthen this analysis, I would like to identify an appropriate sample of vessels that acccurately represent the PNA. This vessels must meet at least these two points: i) belong to the PNA and ii) Have fished for a significant amount of time inside PIPA, to count as "treated". Ideally, this would get rid of vessels that sporadically fished for insignificant time in PIPA, and are therefore unlikely to be affected. This would include between 12 and  vessels (number of Kiribati vessels vs. number of all vessels who fished in PIPA at least once before 2015). -->

<!-- I would also like to explore the possibility of identifying a plausible counterfactual. That way we could do something like a DiD. I think it is possible to identify counterfactual boats. I would start by identifying vessels who meet at least these four criteria: i) fish in near-by regions, ii) have same gear as vessels from PIPA, and iii) having similar length of data, and iv) never fished inside PIPA. Perhaps an additional one would be that they belong to the PNA. -->

<!-- Additionally, run similar regressions on distance traveled, and total vessel hours (not just fishing hours), that could account for the extended "search" time. -->

<!-- \clearpage -->

<!-- # Possible contributions -->

<!-- As I understand the efforts made so far, there are two straightforward ways in which I could contribute to this study. For the first one I would help strengthen the analysis of NOAA Observer and GFW data for the US PNMs. The second one would involve conducting the analysis of GFW data for PIPA, and translating the results into implications for Palau. I discuss these two in greater detail in the next paragraphs. -->

<!-- ## US Pacific Monuments -->

<!-- In this section I include possible analysis in which I could help. When relevant, I include quotes to provide context. Comments are organized with headings similar to the ones included in the original manuscript. I believe my suggestions would compliment (rather than replace) current analysis, and I acknowledged that you might have already tried some or that due to data constraints not all of them are possible. -->

<!-- ### Total revenue -->

<!-- "It is very clear from the figure that total catch of bigeye has not declined as a result of the 2014 or -->
<!-- 2016 expansions". Of course, I have not reviewed the data. But is it safe to conclude this? At least through time there isn't an evident decrease, but what would have catches looked like had PMNM not been expanded? -->

<!-- Not sure if the spatial resolution (*i.e.* Catch Blocks) in logbooks allows this comparison, but it would be interesting to see what proportion of catches (or at least sets / hours) originally came from waters inside the PMNM. Perhaps the georeferenced catches from NOAA Observer data can provide insights into this (if not for the entire fleet, at least for the 20% quasi-random subset), or we can use GFW data to see if the proportion of fishing hours inside PMNM roughly corresponds to 10M in revenues (we can test different "catch rates" to account for the fact that catches inside vs outside may not map 1:1). Perhaps this catch efficiency ratio can be extracted from the NOAA Observer data? -->

<!-- On aggregate the fleet brought in more money in 2015 and 1016 than in previous year, but you discuss the possibility that the distributional effects of this might be different. I would assume that vessels who fished the most in the PMNM area were the ones who took the toughest hit. If possible, it might be interesting to birefly look at distributional effects for the discussion. -->

<!-- ### Total costs (TC) -->

<!-- So far this section describes the available data, but it it's not clear whether the empirical strategy is fully developed. Just like the datasets, a there isn't a single best analysis that provides the answer, but looking at it from as many was as possible might help paint a full picture of the effects that vLPAs have had.Here I provide some ideas in which we could use the two main datasets (NOAA and GFW data) to indirectly test the claims made by the fleet. -->

<!-- #### TC from NOAA Observer program -->

<!-- You mention that a drawback of this dataset is that you only observe fishing events, and not the entire trip (*i.e.* the search and travel). It might be worth looking into combining this with GFW data. NOAA observer program would provide real fishing events (as opposed to the ones predicted by GFW's neural net), and GFW would provide the entire track. Given that NOAA data cover 20% and GFW only contain 60 boats, we will not get full coverage. If this doesn't yield better data, it would at least help determine if the three-day space between sets is an appropriate way of grouping them into "trips". -->

<!-- Results in your table 3 suggest that there's been a change of ~ 20 miles (positive or negative depending on model specification), and not significant. Perhaps linking this data to GFW would provide full tracks (of a smaller portion of the fleet) to then account for distance between fishing points but also during the search and set activities. -->

<!-- #### TC form GFW Data -->

<!-- We could also test the increased cost claim by looking at the almost 60 vessels and calculate an estimate of fuel consumption (following @sala_2018), which, paired with fuel prices, might provide cost estimates[^1]. Initially this would just be a regression with a policy dummy (and appropriate vessel- and month-level FE's). We could look into GFW data to identify plausible counterfactuals to include  a control group[^2]. -->

<!-- [^1]: Of course, there are additional costs (*e.g.* crew, ice, bait, gear), but fuel should represent a large portion of this and should scale with some measures of fishing effort (time and distance). If this is not enough, the previous comparison of catches (sets) that came from PMNM waters before the implementation could provide some insights. -->

<!-- [^2]: GFW increased coverage when they added from more satellites, particularly towards the end of 2016 and throughout 2017, I believe. I think it would be important to use counterfactuals in any GFW-related analyses to account for the expected temporal trend in increased effort. -->

<!-- # Other details -->

<!-- - The introduction states that the main objective is to quantify the economic impacts of vLPAs and compare the cost per hectare to vLPAs on land. I think this would provide an interesting benchmark on cost of conservation per unit area in land vs sea. I would perhaps highlight the part about predicting the possible effects of the Palau MPA. -->

<!-- - I think the novelty of the paper can be highlighted even more. @stevenson_2013 evaluated the consequences of fishing displacement from MPAs in Hawaii (a smaller network and totally different fleet). They show that fishing effort was indeed displaced to places further away from ports representing increased costs, but that CPUE also increased. Overall, they don't find a negative impact on the *perceived* socioeconomic well-being of fishers. However, they do not have plausible counterfacutals and rely on before-after comparisons of perceptions. I think the novelty of this paper is not only the size, resolution, and quality of the data, but the fact that it has a BACI design enabling the identification of the net effect that vLPAs have on fishers. And also the larger contribution to vLPAs (and MPAs in general) literature. -->
<!-- - Recent work by @sala_2018 shows that a large portion of high-seas fishing is only profitable thanks to subsidies. This could compliment @white_2014 and @sumaila_2015 in the introduction. -->

<!-- - "Neither of these datasets is perfect but hopefully combined they will paint a clear picture of what the impact has been". I find this to be a modest (or humble?) and powerful sentence that highlights the efforts made to identify effects from different sources, and that acknowledges possible data limitations. This sentence should be included alongside the "novelty" in the last paragraph of the introduction. -->

<!-- - Findings by @smith_2006 show negative effects, but the reserves were only in place for a short period. I believe they talk about this in their discussion. @edgar_2014-UO and @difranco_2016-Xw show how the effects (at least inside vs outside the reserve) can take up to 10 years. -->

<!-- - I would be cautious on the interpretation of results by @sumaila_2015. They do show that < 0.01% of catch and landed values come *exclusively* from the high seas, but also that 67% and 72% (catch and value) come from Both EEZs and High seas, and the remaining from EEZs only. @pauly_2016 show that ~6% of landings come from the high seas (Fig. \ref{fig:eez-hs}). It's perhaps a minor detail, but thought I'd point it out. -->

# References
